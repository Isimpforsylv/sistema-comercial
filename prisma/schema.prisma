// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Usuarios {
  id           Int      @id @default(autoincrement())
  nome         String   @db.VarChar(255)
  email        String   @unique @db.VarChar(255)
  senha        String   @db.VarChar(255)
  admin        Boolean  @default(false)
  criadoem     DateTime @default(now())
  atualizadoem DateTime @updatedAt

  @@map("usuarios")
}

model EmpresasGrupo {
  id        Int       @id @default(autoincrement())
  nomegrupo String    @db.VarChar(255)
  empresas  Empresas[]

  @@map("empresas_grupo")
}

model Empresas {
  id             Int             @id @default(autoincrement())
  idgrupo        Int?
  nomeempresa    String          @db.VarChar(255)
  codigoempresa  String          @db.VarChar(100)
  cliente        Boolean         @default(false)
  criadopor      String          @db.VarChar(255)
  criadoem       DateTime        @default(now())
  atualizadoem   DateTime        @updatedAt
  
  grupo          EmpresasGrupo?  @relation(fields: [idgrupo], references: [id])

  propostasAceitas PropostasAceitas[]

  @@map("empresas")
}

model PropostasAceitas {
  id           Int      @id @default(autoincrement())
  idempresa    Int
  nomeproposta String   @db.VarChar(255)
  criadoem     DateTime @default(now())
  atualizadoem DateTime @updatedAt

  empresa      Empresas @relation(fields: [idempresa], references: [id])
  informacoes  InformacoesPropostasAceitas?
  valores      ValoresPropostasAceitas[]
  servicos     ServicosPropostasAceitas[]

  @@map("propostas_aceitas")
}

model InformacoesPropostasAceitas {
  id            Int      @id @default(autoincrement())
  idproposta    Int      @unique
  empresa       String   @db.VarChar(255)
  pais          String   @db.VarChar(100)
  estado        String   @db.VarChar(100)
  cidade        String   @db.VarChar(255)
  endereco      String   @db.VarChar(500)
  contato       String   @db.VarChar(255)
  email         String   @db.VarChar(255)
  telefone      String   @db.VarChar(50)
  linkwiki      String   @db.VarChar(500)
  caminhopasta  String   @db.VarChar(500) @default("\\\\serverideia2\\Comercial")
  dataaceite    DateTime @default(now())
  criadopor     String   @db.VarChar(255) @default("Sistema")
  atualizadopor String   @db.VarChar(255) @default("Sistema")
  criadoem      DateTime @default(now())
  atualizadoem  DateTime @updatedAt

  proposta      PropostasAceitas @relation(fields: [idproposta], references: [id])

  @@map("informacoespropostas_aceitas")
}

model ValoresPropostasAceitas {
  id                    Int      @id @default(autoincrement())
  idproposta            Int
  nomevalor             String   @db.VarChar(255)
  valor                 String   @db.VarChar(100)
  formapagamento        String   @db.VarChar(255)
  mensalidade           String   @db.VarChar(100)
  alteracaomensalidade  String   @db.VarChar(255)
  prazo                 String   @db.VarChar(255)
  observacao            String   @db.Text
  criadopor             String   @db.VarChar(255) @default("Sistema")
  atualizadopor         String   @db.VarChar(255) @default("Sistema")
  criadoem              DateTime @default(now())
  atualizadoem          DateTime @updatedAt

  proposta              PropostasAceitas @relation(fields: [idproposta], references: [id])
  recursos              RecursosValoresPropostasAceitas[]

  @@map("valorespropostas_aceitas")
}

model ListaRecursos {
  id           Int      @id @default(autoincrement())
  nomerecurso  String   @db.VarChar(255)
  
  @@map("listarecursos")
}

model RecursosValoresPropostasAceitas {
  id              Int      @id @default(autoincrement())
  idvalor         Int
  nomerecurso     String   @db.VarChar(255)
  valor           String   @db.VarChar(100)
  formapagamento  String   @db.VarChar(255)
  prazo           String   @db.VarChar(255)
  criadopor       String   @db.VarChar(255) @default("Sistema")
  atualizadopor   String   @db.VarChar(255) @default("Sistema")
  criadoem        DateTime @default(now())
  atualizadoem    DateTime @updatedAt

  valor_ref       ValoresPropostasAceitas @relation(fields: [idvalor], references: [id], onDelete: Cascade)

  @@map("recursosvalorespropostas_aceitas")
}

model TipoServico {
  id              Int      @id @default(autoincrement())
  nometiposervico String   @db.VarChar(255)
  
  servicos        ServicosPropostasAceitas[]

  @@map("tiposervico")
}

model ServicosPropostasAceitas {
  id             Int      @id @default(autoincrement())
  idproposta     Int
  idtiposervico  Int
  nomedescricao  String   @db.VarChar(255)
  criadopor      String   @db.VarChar(255) @default("Sistema")
  atualizadopor  String   @db.VarChar(255) @default("Sistema")
  criadoem       DateTime @default(now())
  atualizadoem   DateTime @updatedAt

  proposta       PropostasAceitas @relation(fields: [idproposta], references: [id])
  tiposervico    TipoServico @relation(fields: [idtiposervico], references: [id])
  checklist      Checklist?
  melhoria       Melhoria?

  @@map("servicospropostas_aceitas")
}

model Checklist {
  id            Int      @id @default(autoincrement())
  idservico     Int      @unique
  criadopor     String   @db.VarChar(255) @default("Sistema")
  atualizadopor String   @db.VarChar(255) @default("Sistema")
  criadoem      DateTime @default(now())
  atualizadoem  DateTime @updatedAt

  servico       ServicosPropostasAceitas @relation(fields: [idservico], references: [id], onDelete: Cascade)
  etapas        ChecklistEtapas[]
  observacoes   ChecklistObservacoes[]

  @@map("checklist")
}

model ChecklistEtapas {
  id                    Int       @id @default(autoincrement())
  idchecklist           Int
  nometapa              String    @db.VarChar(255)
  dataenvio             DateTime?
  dataretorno           DateTime?
  cobrarem              DateTime?
  historicodataenvio    String?   @db.Text
  historicodataretorno  String?   @db.Text
  criadopor             String    @db.VarChar(255) @default("Sistema")
  atualizadopor         String    @db.VarChar(255) @default("Sistema")
  criadoem              DateTime  @default(now())
  atualizadoem          DateTime  @updatedAt

  checklist             Checklist @relation(fields: [idchecklist], references: [id], onDelete: Cascade)

  @@map("checklist_etapas")
}

model ChecklistObservacoes {
  id            Int      @id @default(autoincrement())
  idchecklist   Int
  nometapa      String   @db.VarChar(255)
  observacao    String   @db.Text
  criadopor     String   @db.VarChar(255) @default("Sistema")
  atualizadopor String   @db.VarChar(255) @default("Sistema")
  criadoem      DateTime @default(now())
  atualizadoem  DateTime @updatedAt

  checklist     Checklist @relation(fields: [idchecklist], references: [id], onDelete: Cascade)

  @@map("checklist_observacoes")
}

model Melhoria {
  id            Int      @id @default(autoincrement())
  idservico     Int      @unique
  criadopor     String   @db.VarChar(255) @default("Sistema")
  atualizadopor String   @db.VarChar(255) @default("Sistema")
  criadoem      DateTime @default(now())
  atualizadoem  DateTime @updatedAt

  servico       ServicosPropostasAceitas @relation(fields: [idservico], references: [id], onDelete: Cascade)

  @@map("melhoria")
}
